13/07 14:49:38 INFO:

##			Creating TreeSAPP reference package			##

13/07 14:49:38 INFO:
Arguments used:
-i Hydrocarbons/PHA_degradation/PETases.fasta -o Hydrocarbons/PHA_degradation/PHA_depolymerases --trim_align -n 2 --headless --cluster -p 0.99 -c PHAdeg -m prot --overwrite --delete --fast -b 0 --stage build

13/07 14:49:38 WARNING:
Unable to run 'build' as it is ahead of the last completed stage.
Continuing with stage 'lineages'

13/07 14:49:38 DEBUG:
Hydrocarbons/PHA_degradation/PETases.fasta read by pyfastx in 0.00012111663818359375 seconds.

13/07 14:49:38 DEBUG:
Read 11 headers from Hydrocarbons/PHA_degradation/PETases.fasta.

13/07 14:49:38 DEBUG:
Identified and replaced invalid ambiguity characters in 0 sequences.

13/07 14:49:38 INFO:
Sequence summary:
	Number of sequences: 11
	Longest sequence length: 489
	Shortest sequence length: 214
	Mean sequence length: 291.0
	Median sequence length: 262

13/07 14:49:38 INFO:
Extracting information from headers... 
13/07 14:49:38 INFO:
done.

13/07 14:49:38 DEBUG:
	Number of input sequences =	11

13/07 14:49:38 DEBUG:
	Number of queries =	11

13/07 14:49:38 INFO:
Preparing Bio.Entrez for NCBI queries... 
13/07 14:49:38 INFO:
done.

13/07 14:49:38 INFO:
Retrieving Entrez taxonomy records for each accession... 
13/07 14:49:39 DEBUG:
Entrez query time for accessions (minutes:seconds):
	0 - 100	0.0:0.95

13/07 14:49:39 INFO:
done.

13/07 14:49:39 DEBUG:
9 unique organism queries.

13/07 14:49:39 INFO:
Retrieving NCBI taxonomy IDs for each organism... 
13/07 14:49:45 DEBUG:
Entrez query time for accessions (minutes:seconds):
	0 - 1	0.0:0.66
	1 - 2	0.0:0.66
	2 - 3	0.0:0.66
	3 - 4	0.0:0.66
	4 - 5	0.0:0.66
	5 - 6	0.0:0.66
	6 - 7	0.0:0.66
	7 - 8	0.0:0.66
	8 - 9	0.0:0.66

13/07 14:49:45 INFO:
done.

13/07 14:49:45 INFO:
Preparing Bio.Entrez for NCBI queries... 
13/07 14:49:46 INFO:
done.

13/07 14:49:46 INFO:
Retrieving lineage information for each taxonomy ID... 
13/07 14:49:46 DEBUG:
Entrez query time for accessions (minutes:seconds):
	0 - 100	0.0:0.66

13/07 14:49:46 INFO:
done.

13/07 14:49:46 DEBUG:
Queries mapped ideally = 11
Queries with organism unmapped = 0
Queries with NCBI taxonomy ID unmapped = 0
Queries mapped with alternative accessions = 0
Queries that outright failed = 0

13/07 14:49:46 DEBUG:
Entrez.efetch query stats:
	Downloaded	11
	Provided	0
	Total		11


13/07 14:49:46 DEBUG:
Switching multifurcating trie to include rank prefixes.

13/07 14:49:46 WARNING:
Order of taxonomic ranks in cleaned lineage 'd__Bacteria; p__Proteobacteria; c__Betaproteobacteria; o__Burkholderiales; g__Ideonella; s__Ideonella sakaiensis' is unexpected.
Lineage will be truncated to 'd__Bacteria; p__Proteobacteria; c__Betaproteobacteria; o__Burkholderiales'.

13/07 14:49:46 WARNING:
Order of taxonomic ranks in cleaned lineage 'd__Bacteria; s__uncultured bacterium' is unexpected.
Lineage will be truncated to 'd__Bacteria'.

13/07 14:49:46 DEBUG:
No lineages from the accession map were added to the EntrezRecord attributes.

13/07 14:49:46 INFO:
Clustering sequences with UCLUST... 
13/07 14:49:46 INFO:
done.

13/07 14:49:46 DEBUG:
usearch v11.0.667_i86linux32, 4.0Gb RAM (32.9Gb total), 4 cores
(C) Copyright 2013-18 Robert C. Edgar, all rights reserved.
https://drive5.com/usearch

License: c.morganlang@gmail.com

00:00 37Mb      0.1% Reading /home/connor/Bioinformatics/Hallam_projects/RefPkgs/Hydrocarbons/PHA_degradation/PHA_depolymerases/intermediates/PETases_uclust_input.fasta00:00 41Mb    100.0% Reading /home/connor/Bioinformatics/Hallam_projects/RefPkgs/Hydrocarbons/PHA_degradation/PHA_depolymerases/intermediates/PETases_uclust_input.fasta
00:00 35Mb     50.0% DF                                                                                                                                                 00:00 35Mb    100.0% DF
00:00 35Mb   11 seqs, 11 uniques, 11 singletons (100.0%)
00:00 35Mb   Min size 1, median 1, max 1, avg 1.00
00:00 39Mb      9.1% DB00:00 39Mb    100.0% DB
00:00 39Mb   Sort length... done.
00:00 78Mb      8.3% Clustering00:00 78Mb      8.3% 0 clusters, max size 0, avg 0.000:00 89Mb    100.0% 10 clusters, max size 2, avg 1.1
00:00 89Mb     10.0% Writing centroids to /home/connor/Bioinformatics/Hallam_projects/RefPkgs/Hydrocarbons/PHA_degradation/PHA_depolymerases/intermediates/PETases_uclust0.99.fa00:00 89Mb    100.0% Writing centroids to /home/connor/Bioinformatics/Hallam_projects/RefPkgs/Hydrocarbons/PHA_degradation/PHA_depolymerases/intermediates/PETases_uclust0.99.fa
                                                                                                                                                                                
      Seqs  11
  Clusters  10
  Max size  2
  Avg size  1.1
  Min size  1
Singletons  9, 81.8% of seqs, 90.0% of clusters
   Max mem  89Mb
      Time  1.00s
Throughput  11.0 seqs/sec.


13/07 14:49:46 DEBUG:
Reading usearch cluster file... 
13/07 14:49:46 DEBUG:
done.

13/07 14:49:46 DEBUG:
	10 sequence clusters

13/07 14:49:46 DEBUG:
Finalizing representative sequence clusters... 
13/07 14:49:46 DEBUG:
done.

13/07 14:49:46 DEBUG:
Re-enumerating the reference sequences in taxonomic order... 
13/07 14:49:46 DEBUG:
done.

13/07 14:49:46 DEBUG:
11 references before and 10 remaining after filtering.

13/07 14:49:46 DEBUG:
Removing 1 taxa (1 unique) from taxonomic hierarchy.

13/07 14:49:46 INFO:
Number of unique lineages:
	domain     2
	phylum     4
	class      4
	order      5
	family     4
	genus      5
	species    8
Unclassified and incomplete lineages account for 2/10 (20.0%) references.

13/07 14:49:46 INFO:
Aligning the sequences using MAFFT... 
13/07 14:49:47 INFO:
done.

13/07 14:49:47 DEBUG:
Read 10 headers from /home/connor/Bioinformatics/Hallam_projects/RefPkgs/Hydrocarbons/PHA_degradation/PHA_depolymerases/final_outputs/PHAdeg.fa.

13/07 14:49:47 DEBUG:
Reference alignment contains 10 sequences with 546 character positions.

13/07 14:49:47 DEBUG:
Building HMM profile... 
13/07 14:49:47 DEBUG:
done.

13/07 14:49:47 DEBUG:
Creating taxonomically-dereplicated HMM... 
13/07 14:49:47 DEBUG:
Read 10 headers from /home/connor/Bioinformatics/Hallam_projects/RefPkgs/Hydrocarbons/PHA_degradation/PHA_depolymerases/final_outputs/PHAdeg.fa.

13/07 14:49:47 DEBUG:
2 lineages truncated before 'genus' were removed during lineage trimming.

13/07 14:49:47 DEBUG:
The following sequences were excluded after synchronizing FASTA:
	5_PHAdeg
	3_PHAdeg
	4_PHAdeg
	6_PHAdeg

13/07 14:49:47 DEBUG:
Building HMM profile... 
13/07 14:49:47 DEBUG:
done.

13/07 14:49:47 DEBUG:
done.

13/07 14:49:47 DEBUG:
6 genus-dereplicated sequences retained for building HMM profile.

13/07 14:49:47 INFO:
Running BMGE... 
13/07 14:49:47 DEBUG:
STAGE: Multiple alignment trimming with BMGE
	COMMAND:
java -Xmx512m -jar /home/connor/Bioinformatics/Hallam_projects/TreeSAPP_manuscript/treesapp_venv/lib/python3.7/site-packages/treesapp/sub_binaries/BMGE.jar -t AA -m BLOSUM30 -g 0.99:0.33 -i /home/connor/Bioinformatics/Hallam_projects/RefPkgs/Hydrocarbons/PHA_degradation/PHA_depolymerases/final_outputs/PHAdeg.fa -of /home/connor/Bioinformatics/Hallam_projects/RefPkgs/Hydrocarbons/PHA_degradation/PHA_depolymerases/final_outputs/PHAdeg-BMGE.fasta

13/07 14:49:48 INFO:
done.

13/07 14:49:48 DEBUG:
	BMGE time required: 0.0:0.0:0.22

13/07 14:49:48 DEBUG:
Number of sequences discarded: 
		/home/connor/Bioinformatics/Hallam_projects/RefPkgs/Hydrocarbons/PHA_degradation/PHA_depolymerases/final_outputs/PHAdeg-BMGE.fasta = 0 (retained)

13/07 14:49:48 INFO:
Building phylogenetic tree with FastTree... 
13/07 14:49:48 INFO:
done.

13/07 14:49:48 DEBUG:
FastTree Version 2.1.10 Double precision (No SSE3)
Alignment: /home/connor/Bioinformatics/Hallam_projects/RefPkgs/Hydrocarbons/PHA_degradation/PHA_depolymerases/intermediates/PHAdeg.phy
Amino acid distances: BLOSUM45 Joins: balanced Support: SH-like 1000
Search: Normal +NNI +SPR (2 rounds range 10) +ML-NNI opt-each=1
TopHits: 1.00*sqrtN close=default refresh=0.80
ML Model: Le-Gascuel 2008, CAT approximation with 4 rate categories
Initial topology in 0.00 seconds
Refining topology: 13 rounds ME-NNIs, 2 rounds ME-SPRs, 7 rounds ML-NNIs
Total branch-length 3.862 after 0.02 sec
ML-NNI round 1: LogLk = -3277.043 NNIs 2 max delta 1.54 Time 0.08
Switched to using 4 rate categories (CAT approximation)
Rate categories were divided by 0.828 so that average rate = 1.0
CAT-based log-likelihoods may not be comparable across runs
ML-NNI round 2: LogLk = -3168.238 NNIs 0 max delta 0.00 Time 0.11
Turning off heuristics for final round of ML NNIs (converged)
      0.11 seconds: ML NNI round 3 of 7, 1 of 8 splits
ML-NNI round 3: LogLk = -3168.110 NNIs 0 max delta 0.00 Time 0.16 (final)
Optimize all lengths: LogLk = -3168.083 Time 0.17
      0.21 seconds: Optimizing alpha round 2
Gamma(4) LogLk = -3267.741 alpha = 4.176 rescaling lengths by 1.085
Total time: 0.22 seconds Unique: 10/10 Bad splits: 0/7


13/07 14:49:48 DEBUG:
Evaluating phylogenetic tree with RAxML-NG... 
13/07 14:49:48 DEBUG:
done.

13/07 14:49:48 INFO:
Skipping training:
$ treesapp train -i /home/connor/Bioinformatics/Hallam_projects/RefPkgs/Hydrocarbons/PHA_degradation/PHA_depolymerases/intermediates/PETases_filtered.fa -r /home/connor/Bioinformatics/Hallam_projects/RefPkgs/Hydrocarbons/PHA_degradation/PHA_depolymerases/final_outputs/PHAdeg_build.pkl -o /home/connor/Bioinformatics/Hallam_projects/RefPkgs/Hydrocarbons/PHA_degradation/PHA_depolymerases/intermediates/placement_trainer/ -m prot -a /home/connor/Bioinformatics/Hallam_projects/RefPkgs/Hydrocarbons/PHA_degradation/PHA_depolymerases/intermediates//accession_id_lineage_map.tsv -n 2 --trim_align.

13/07 14:49:48 INFO:

To integrate this package for use in TreeSAPP the following steps must be performed:
1. Replace the current refpkg_code 'Z1111' with:
`treesapp package edit refpkg_code $code --overwrite --refpkg_path /home/connor/Bioinformatics/Hallam_projects/RefPkgs/Hydrocarbons/PHA_degradation/PHA_depolymerases/final_outputs/PHAdeg_build.pkl` where $code is a unique identifier.
2. Copy /home/connor/Bioinformatics/Hallam_projects/RefPkgs/Hydrocarbons/PHA_degradation/PHA_depolymerases/final_outputs/PHAdeg_build.pkl to a directory containing other reference packages you want to analyse. This may be in /home/connor/Bioinformatics/Hallam_projects/TreeSAPP_manuscript/treesapp_venv/lib/python3.7/site-packages/treesapp//data/ or elsewhere

13/07 14:49:48 INFO:
TreeSAPP has finished successfully.

